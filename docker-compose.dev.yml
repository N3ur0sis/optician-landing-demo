# ============================================
# OPTICIAN CMS - Docker Compose Development Override
# ============================================
#
# This file extends docker-compose.yml for local development.
# NOT tracked in git - create locally for development only.
#
# Usage:
#   docker compose -f docker-compose.yml -f docker-compose.dev.yml up --build
#
# ============================================

services:
  # =================================
  # Database (Development Overrides)
  # =================================
  db:
    container_name: optician-db-dev
    # Expose port for local database tools
    ports:
      - "${POSTGRES_PORT:-5432}:5432"
    volumes:
      - postgres_data_dev:/var/lib/postgresql/data

  # =================================
  # Web Application (Development Overrides)
  # =================================
  web:
    container_name: optician-web-dev
    
    build:
      target: development
    
    environment:
      NODE_ENV: development
    
    volumes:
      # Mount source code for hot-reload
      - .:/app
      # Prevent overwriting container's node_modules
      - /app/node_modules
      - /app/.next
      # Keep uploads accessible locally
      - ./public/uploads:/app/public/uploads

# =================================
# Development Volumes
# =================================
volumes:
  postgres_data_dev:
    name: optician-postgres-data-dev
